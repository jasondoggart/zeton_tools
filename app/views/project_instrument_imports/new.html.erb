<div class="section-heading">
  Import Instruments from Excel
</div>
<div class="item-sub-heading">
  <div class="item-sub-heading-icon">
    <i class="fas fa-list-ul"></i>
  </div>
  <div class="item-sub-heading-text">
    Instructions
  </div>
</div>
<div class="main-container">
  <div class="row">
    <div class="col-sm-12">
      <h6>
        Only import spreadsheets that were previously downloaded
        from your project on Zeton Project Tools
      </h6>
      <p class="card-text">
      Importing an Excel spreadsheet allows for the following:
      </p>
      <ul>
        <li>Updating existing instruments</li>
        <li>Creating new instruments</li>
      </ul>
      <p>
      Instruments in the spreadsheet that have an id (those that were
      downloaded and updated by you) will be updated only.
      </p>
      <p>
      New instruments that you've added to the sheet will be created in
      your project (project <%= current_project.project_number %>).  Note:
      do not add an id to new instruments - these will be added automatically
      on import.
      </p>
      <h5 class="card-title mt-5">
        Requirements
      </h5>
      <p>The following are required for all instruments (whether updating
      or creating new instruments</p>
      <ul>
        <li>An instrument type (FIT, PIT, LV, etc)</li>
        <li>A loop number (this can be a temporary number, or "XXXX")</li>
      </ul>
      <h5 class="card-title mt-5">
        Add File
      </h5>
    </div>
  </div>
  <div class="row">
    <div class="col-sm-12">
      <%= form_for @project_instruments_import do |f| %>
        <% if @project_instruments_import.errors.any? %>
          <div class="alert alert-warning">
            <%= pluralize(@project_instruments_import.errors.count, 'error') %> stopped the import from proceeding
            <ul>
              <%= @project_instruments_import.errors.full_messages.each do |msg| %>
                <li><%= msg %></li>
              <% end %>
            </ul>
          </div>
        <% end %>
        <div class="form-group">
          <div class="row">
            <div class="col-sm-12">
              <%= f.file_field :file %>
            </div>
          </div>
          <div class="row mt-3">
            <div class="col-sm-12">
              <%= f.hidden_field :project, value: current_project.id %>
              <%= f.submit "Import XLSX", class: 'form-submit-button' %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
